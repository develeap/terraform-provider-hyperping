# v1.0.5 Release Plan - Complete ISS-005/006/007 Fixes

**Date:** 2026-02-09
**Current Version:** v1.0.4 (Released but incomplete)
**Target Version:** v1.0.5 (Bug fixes)

---

## Executive Summary

v1.0.4 was released with PARTIAL fixes for critical bugs. Additional work is needed.

### What v1.0.4 Fixed ‚úÖ
- ‚úÖ Read-after-create pattern (ISS-005, ISS-006) - implemented but incomplete
- ‚úÖ Status page subdomain normalization (ISS-007.1) - working
- ‚úÖ Status page language filtering (ISS-007.2) - working

### What v1.0.4 DIDN'T Fix ‚ùå
- ‚ùå Incident/Maintenance `text` field drift (ISS-005, ISS-006) - **NOW FIXED** in main
- ‚ùå Status page `settings.name` override (ISS-007.3) - needs implementation
- ‚ùå Status page `show_response_times` flip (ISS-007.4) - needs investigation

---

## Current Branch Status

### Committed to `main` (Not Yet Released)

**Commit:** `cffba70` - "fix: preserve plan values for write-only fields"

**Changes:**
1. `incident_resource.go` - Conditional text field mapping
2. `maintenance_resource.go` - Conditional text field mapping
3. `docs/API_MISMATCH_ANALYSIS.md` - Root cause documentation
4. `DEBUG_ISS-005-006-007.md` - Debugging guide

**Test Results:**
```
‚úÖ All incident tests pass (9/9)
‚úÖ All maintenance tests pass (11/11)
‚úÖ All status page tests pass (5/5)
```

**What This Fixes:**
- Incident `text` field no longer causes drift
- Maintenance `text` field no longer causes drift
- Works with both mock servers AND real API

---

## Remaining Work for v1.0.5

### High Priority (Release Blockers)

#### 1. Test with Real Hyperping API ‚ö†Ô∏è CRITICAL

The current fix works with mock servers, but MUST be validated against live API:

```bash
# Set up test environment
export HYPERPING_API_KEY="sk_your_key"
export STATUS_PAGE_UUID="sp_your_status_page"

# Test incident resource
terraform apply -target=hyperping_incident.test
terraform plan  # Should show "No changes"
terraform state show hyperping_incident.test  # Verify text field populated

# Test maintenance resource
terraform apply -target=hyperping_maintenance.test
terraform plan  # Should show "No changes"
terraform state show hyperping_maintenance.test  # Verify text field populated
```

**If text field is STILL empty after apply, we need deeper investigation.**

#### 2. Fix Status Page settings.name (ISS-007.3)

**Current Issue:**
```hcl
resource "hyperping_statuspage" "test" {
  name = "Resource Name"
  settings = {
    name = "Custom Settings Name"  # Gets overridden!
  }
}
```

**Solution Options:**

**A) Plan Preservation (Recommended)**
```go
// Preserve settings.name from plan since API overwrites it
if !model.Settings.IsNull() {
    planSettingsAttrs := model.Settings.Attributes()
    if planName, ok := planSettingsAttrs["name"].(types.String); ok && !planName.IsNull() {
        // Don't use API value - keep plan value
    }
}
```

**B) Documentation (Alternative)**
Document that `settings.name` is not supported and users should use resource-level `name` only.

---

### Medium Priority (Can Be Deferred)

#### 3. Investigate show_response_times (ISS-007.4)

Need to test with real API to determine if this is:
- Provider parsing bug
- API persistence bug
- Default value issue

**Test Plan:**
```bash
# Create with show_response_times = true
# Verify API actually persists it
curl -X GET "https://api.hyperping.io/v2/statuspages/{uuid}" | \
  jq '.sections[0].services[0].show_response_times'

# If API returns false when we sent true -> API bug
# If API returns true but provider maps to false -> Provider bug
```

---

## v1.0.5 Release Checklist

### Before Release

- [ ] **Test with real Hyperping API** (incident + maintenance text fields)
- [ ] Decide on settings.name fix approach (implement or document)
- [ ] Investigate show_response_times (or defer to v1.0.6)
- [ ] Update CHANGELOG with complete v1.0.5 notes
- [ ] Run full test suite: `TF_ACC=1 go test ./... -v`
- [ ] Build locally and test with example Terraform configs
- [ ] Update README if API limitations need documenting

### Release Process

```bash
# 1. Update CHANGELOG
# Move [Unreleased] changes to [1.0.5] - 2026-02-XX

# 2. Commit changelog
git add CHANGELOG.md
git commit -m "docs: update CHANGELOG for v1.0.5"

# 3. Create and push tag
git tag -a v1.0.5 -m "v1.0.5 - Complete fixes for ISS-005, ISS-006, partial ISS-007"
git push origin main --tags

# 4. Publish GitHub release (after GoReleaser completes)
gh release edit v1.0.5 --draft=false

# 5. Verify Terraform Registry auto-detects new version
```

### After Release

- [ ] Test provider from Terraform Registry
- [ ] Notify users of fixes via GitHub release notes
- [ ] Close related issues (ISS-005, ISS-006)
- [ ] Create new issue for remaining ISS-007 problems if deferred

---

## Risk Assessment

### Low Risk Changes (Ready to Ship)
- ‚úÖ Incident text field preservation - tested with mocks
- ‚úÖ Maintenance text field preservation - tested with mocks

### Medium Risk Changes (Need Validation)
- ‚ö†Ô∏è Real API testing - might reveal additional issues
- ‚ö†Ô∏è Status page settings.name - need to choose approach

### High Risk Changes (Defer if Unsure)
- üî• show_response_times fix without understanding root cause

---

## Recommendation

### Option A: Quick v1.0.5 (Recommended)

**Ship Now:**
- Incident text fix ‚úÖ
- Maintenance text fix ‚úÖ
- Updated documentation ‚úÖ

**Defer to v1.0.6:**
- Status page settings.name (needs design decision)
- Status page show_response_times (needs investigation)

**Rationale:**
- Fixes 2/3 of critical bugs immediately
- Low risk (well-tested with mocks)
- Users get relief faster
- Remaining issues are edge cases

### Option B: Complete v1.0.5

**Wait and include:**
- All ISS-005/006/007 fixes in one release

**Rationale:**
- More complete fix
- Less release churn
- Better user experience (one update fixes everything)

**Risk:**
- Delays incident/maintenance fixes that are ready
- Status page issues need more investigation

---

## Next Steps

1. **USER DECISION:** Quick v1.0.5 or complete v1.0.5?
2. **Test with real API:** Validate text field fixes work
3. **Status page fixes:** Implement or defer?
4. **Release:** Tag and publish when ready

---

## Contact & Support

If live API testing reveals additional issues, we may need to:
- Add more comprehensive debug logging
- Create VCR cassettes with real API responses
- Contact Hyperping support about API inconsistencies
